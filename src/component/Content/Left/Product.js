// import React, { Component } from 'react';

// class Product extends Component {
//     render() {
//         return (
//             <div>
//                 <section className="new_arrivals_area section_padding_100_0 clearfix">
//             <div className="container">
//               <div className="row">
//                 <div className="col-12">
//                   <div className="section_heading text-center">
//                     <h2>New Arrivals</h2>
//                   </div>
//                 </div>
//               </div>
//             </div>
//             <div className="karl-projects-menu mb-100">
//               <div className="text-center portfolio-menu">
//                 <button className="btn active" data-filter="*">ALL</button>
//                 <button className="btn" data-filter=".women">WOMAN</button>
//                 <button className="btn" data-filter=".man">MAN</button>
//                 <button className="btn" data-filter=".access">ACCESSORIES</button>
//                 <button className="btn" data-filter=".shoes">shoes</button>
//                 <button className="btn" data-filter=".kids">KIDS</button>
//               </div>
//             </div>
//             <div className="container">
//               <div className="row karl-new-arrivals">
//                 {/* Single gallery Item Start */}
//                 <div className="col-12 col-sm-6 col-md-4 single_gallery_item women wow fadeInUpBig" data-wow-delay="0.2s">
//                   {/* Product Image */}
//                   <div className="product-img">
//                     <img src="img/product-img/product-1.jpg" alt="" />
//                     <div className="product-quicview">
//                       <a href="#" data-toggle="modal" data-target="#quickview"><i className="ti-plus" /></a>
//                     </div>
//                   </div>
//                   {/* Product Description */}
//                   <div className="product-description">
//                     <h4 className="product-price">$39.90</h4>
//                     <p>Jeans midi cocktail dress</p>
//                     {/* Add to Cart */}
//                     <a href="#" className="add-to-cart-btn">ADD TO CART</a>
//                   </div>
//                 </div>
//                 {/* Single gallery Item Start */}
//                 <div className="col-12 col-sm-6 col-md-4 single_gallery_item women wow fadeInUpBig" data-wow-delay="0.3s">
//                   {/* Product Image */}
//                   <div className="product-img">
//                     <img src="img/product-img/product-2.jpg" alt="" />
//                     <div className="product-quicview">
//                       <a href="#" data-toggle="modal" data-target="#quickview"><i className="ti-plus" /></a>
//                     </div>
//                   </div>
//                   {/* Product Description */}
//                   <div className="product-description">
//                     <h4 className="product-price">$39.90</h4>
//                     <p>Jeans midi cocktail dress</p>
//                     {/* Add to Cart */}
//                     <a href="#" className="add-to-cart-btn">ADD TO CART</a>
//                   </div>
//                 </div>
//                 {/* Single gallery Item Start */}
//                 <div className="col-12 col-sm-6 col-md-4 single_gallery_item access wow fadeInUpBig" data-wow-delay="0.4s">
//                   {/* Product Image */}
//                   <div className="product-img">
//                     <img src="img/product-img/product-3.jpg" alt="" />
//                     <div className="product-quicview">
//                       <a href="#" data-toggle="modal" data-target="#quickview"><i className="ti-plus" /></a>
//                     </div>
//                   </div>
//                   {/* Product Description */}
//                   <div className="product-description">
//                     <h4 className="product-price">$39.90</h4>
//                     <p>Jeans midi cocktail dress</p>
//                     {/* Add to Cart */}
//                     <a href="#" className="add-to-cart-btn">ADD TO CART</a>
//                   </div>
//                 </div>
//                 {/* Single gallery Item Start */}
//                 <div className="col-12 col-sm-6 col-md-4 single_gallery_item shoes wow fadeInUpBig" data-wow-delay="0.5s">
//                   {/* Product Image */}
//                   <div className="product-img">
//                     <img src="img/product-img/product-4.jpg" alt="" />
//                     <div className="product-quicview">
//                       <a href="#" data-toggle="modal" data-target="#quickview"><i className="ti-plus" /></a>
//                     </div>
//                   </div>
//                   {/* Product Description */}
//                   <div className="product-description">
//                     <h4 className="product-price">$39.90</h4>
//                     <p>Jeans midi cocktail dress</p>
//                     {/* Add to Cart */}
//                     <a href="#" className="add-to-cart-btn">ADD TO CART</a>
//                   </div>
//                 </div>
//                 {/* Single gallery Item Start */}
//                 <div className="col-12 col-sm-6 col-md-4 single_gallery_item women wow fadeInUpBig" data-wow-delay="0.6s">
//                   {/* Product Image */}
//                   <div className="product-img">
//                     <img src="img/product-img/product-5.jpg" alt="" />
//                     <div className="product-quicview">
//                       <a href="#" data-toggle="modal" data-target="#quickview"><i className="ti-plus" /></a>
//                     </div>
//                   </div>
//                   {/* Product Description */}
//                   <div className="product-description">
//                     <h4 className="product-price">$39.90</h4>
//                     <p>Jeans midi cocktail dress</p>
//                     {/* Add to Cart */}
//                     <a href="#" className="add-to-cart-btn">ADD TO CART</a>
//                   </div>
//                 </div>
//                 {/* Single gallery Item */}
//                 <div className="col-12 col-sm-6 col-md-4 single_gallery_item kids man wow fadeInUpBig" data-wow-delay="0.7s">
//                   {/* Product Image */}
//                   <div className="product-img">
//                     <img src="img/product-img/product-6.jpg" alt="" />
//                     <div className="product-quicview">
//                       <a href="#" data-toggle="modal" data-target="#quickview"><i className="ti-plus" /></a>
//                     </div>
//                   </div>
//                   {/* Product Description */}
//                   <div className="product-description">
//                     <h4 className="product-price">$39.90</h4>
//                     <p>Jeans midi cocktail dress</p>
//                     {/* Add to Cart */}
//                     <a href="#" className="add-to-cart-btn">ADD TO CART</a>
//                   </div>
//                 </div>
//               </div>
//             </div>
//           </section>
//             </div>
//         );
//     }
// }

// export default Product;


// import React, { Component } from 'react';
// import Item from './Item/Item';
// import { getData } from '../../../data';
// import Btn from '../Btn';
// import AreaBTN from '../AreaBTN';

// class Product extends Component {
//     constructor (props){
//         super(props)
//        this.state = {
//            data : getData("full"),
//            categories : getData ("categories"),
//            click: 0
    
//         }
//     };
//     clickBtn = (status)=>{
//         this.setState({click: status})
//     }
//     render() {
//         return (
//             <>
//             <div >
//                 {this.state.categories.map(ele => {
//                     return (
//                             <div className="text-center portfolio-menu">
//                                 <button className="btn active" data-filter="*"onClick={()=>{this.setState({click: ele.id})}} >{ele.name}{ this.state.click}</button>
//                             </div>
//                         );
//                     })}
//             </div>
//             {
//                 renderProduct (this.state.data, this.state.categories, this.state.click)
//             }
//             </>
//         );
//     }
// }
// var renderProduct = (data,categories,status)=>{
//     if(status === "0" || status === 0){
//     return(
//       <>
//       <div className="text-center mb-4">
//         <h2 className="section-title px-5"><span className="px-2">ALL PRODUCTS</span></h2>
//       </div>
//       <div className="row px-xl-5 pb-3">
//       {data.map((product)=>{
//           return <Item img = {product.img} name = {product.name} price = {product.price}></Item>
//       })}
//       </div>
//     </>
//     )
//   }
//   else{
//     return (
//       <div className="container-fluid pt-5">
//         {categories.filter(check=>{
//           return check.id === status
//         }).map(ele=>{
//          return(
//           <>
//           <div className="text-center mb-4">
//             <h2 className="section-title px-5"><span className="px-2">{ele.name}</span></h2>
//           </div>
//           <div className="row px-xl-5 pb-3">
//           {data.filter(checkArr=>{return checkArr.id === ele.id}).map((product)=>{
//               return <Item img = {product.img} name = {product.name} price = {product.price}></Item>
//           })}
//           </div>
//         </>
//         )
//         })}
//         </div>
//   )
//   }
// }

// export default Product;

// import React, { useState, useEffect } from "react";
// // import "./../assets/css/Product.css";
// import swal from "sweetalert";
// const axios = require("axios").default;

// const successAlert = (name) => {
//   swal({
//     title: "Thank you!",
//     text: `You bought a ${name}! Your order is processing!`,
//     icon: "success",
//   });
// };
// const Product = (props) => {
//   return (
  
   
//                   <div className="col-12 col-sm-6 col-md-4 single_gallery_item women wow fadeInUpBig" data-wow-delay="0.3s">
//                   {/* Product Image */}
//                   <div className="product-img">
//                      <img src={props.img} alt="" />
//                      <div className="product-quicview">
//                        <a href="#" data-toggle="modal" data-target="#quickview"><i className="ti-plus" /></a>
//                      </div>
//                    </div>
//                    {/* Product Description */}
//                  <div className="product-description">
//                      <h4 className="product-price">${props.price}</h4>
//                      <p>{props.name}</p>
//                      {/* Add to Cart */}
//                     <a href="#" className="add-to-cart-btn" onClick={() => successAlert(props.name)}> ADD TO CART</a>
//                     <a href="#" className="add-to-cart-btn" > Edit</a>
//                    </div>
//                  </div>)

// };

// const NewProducts = () => {
//   const [data, setData] = useState({
//     productList: [],
//     categoryList: [],
//     isLoaded: false
//   });
//   const [categoryId, setCategoryId] = useState("0");
//   const getData = async () => {
//     if (!data.isLoaded) {
//       //get categoryList from API
//       var res = await axios(
//         "https://61bec846b25c3a00173f4b70.mockapi.io/Categories"
//       );
//       var categoryList = await res.data;
//       //get productList from API
//       res = await axios(
//         "https://61bec846b25c3a00173f4b70.mockapi.io/Products"
//       );
//       var productList = await res.data;

//       setData({ categoryList, productList, isLoaded: true });
//     }
//   };

//   useEffect(() => {
//     getData(); // eslint-disable-next-line
//   }, []);

//   if (data.isLoaded) {
//     var newProductComponents =
//       categoryId === "all"
//         ? data.productList.map((product) => (
//             <Product
//               key={product.Id}
//               img={product.Image}
//               name={product.Name}
//               price={product.Price}
//               oldPrice={product.OldPrice}
//             />
//           ))
//         : data.productList
//             .filter((product) => product.CategoryID === categoryId)
//             .map((product) => (
//               <Product
//                 key={product.Id}
//                 img={product.Image}
//                 name={product.Name}
//                 price={product.Price}
//                 oldPrice={product.OldPrice}
//               />
//             ));
//     var categoryComponents = data.categoryList.map(category =>
//       {
//                             return (
//                                      <div className="text-center portfolio-menu">
//                                                   <button className="btn active" key={category.Id} onClick={() => setCategoryId(category.Id)}>{category.Name}</button>

//                                      </div>
//                                  );
//                              }
//         )
//     return (
//       <section className="new-products">
//         <h1 className="text-center mb-3">NEW ARRIVALS</h1>
//         <div className="button-nav">
//           {categoryComponents}
//         </div>
//         <div className="row container mx-3">{newProductComponents}</div>
//       </section>
//     );
//   }
//   return <div>Loading...</div>;
// };
// export { Product, NewProducts as default };


import React, { Component } from 'react';
import axios from 'axios';
import {toast} from 'react-toastify';
import swal from "sweetalert";

const successAlert = (name) => {
  swal({
   title: "Thank you!",
    text: `You bought a ${name}! Your order is processing!`,
    icon: "success",
  });
};
class Product extends Component {
  constructor(props) {
    super(props);
    this.state={
      products: [],
      id: '',
      name : '',
      price : '',
      image : '',
      quantity: '',
      oldPrice : '',
    }
    this.onDelete = this.onDelete.bind(this);
    this.onChange = this.onChange.bind(this);
    this.showEditProduct = this.showEditProduct.bind(this);
    this.componentDidMount = this.componentDidMount.bind(this);
  }
  componentDidMount() {
    var {match} = this.props;
    if (match) {
      var id = match.params.id;
      axios({
      method: 'GET',
      url :`http://localhost:3006/products/${id}`,
      data : null
     }).then(res =>{
      var data =res.data;
        this.setState({
          id: data.id,
          name : data.name,
          price : data.price,
          image : data.image,
          quantity: data.quantity,
          oldPrice : data.oldPrice,
        });
      }).catch( err =>{
    });
   }
    axios.get('http://localhost:3007/products').then(res => {
      this.setState({ products:  res.data});
    })
    if(this.state.id==''){
      document.getElementById('image-edit').style.display = 'none';
    }else{
      document.getElementById('image-edit').style.display = 'block';
    }
  }
  getProduct = (id) => {
    for(var i=0; i<this.state.products.length; i++) {
      if (this.state.products[i].id === id) {
        return this.state.products[i];
      }
    }
    return null;
  }
  onChange = (event) =>{
    this.setState({
      [event.target.name]: event.target.value,
    });
  }
  onChangeImage = (event) =>{
    this.setState({
      [event.target.name]: "images/"+event.target.files[0].name,
    });
    console.log(event.target.files[0].name);
  }
  showEditProduct = (id) => {
    var product = this.getProduct(id);
    this.setState({
      id: product.id,
      name: product.name,
      price: product.price,
      oldPrice : product.oldPrice,
      image : product.image,
      quantity : product.quantity,
    });
    document.getElementById('image-edit').style.display = 'block';
    alert(id);
  }
  getIndexProducts = (id) => {
    for(var i=0; i<this.state.products.length; i++) {
      if (this.state.products[i].id === id) {
        return i;
      }
    }
    return -1;
  }
  onSave = (event) => {
    event.preventDefault();
    if (this.state.id ==''){
      if(this.state.name !== '' && this.state.price!=='' && this.state.quantity !== '' && this.state.image!==''){
        axios({
          method:'POST',
          url :`http://localhost:3007/products`,
          data: {
            name: this.state.name,
            price: this.state.price,
            oldPrice : this.state.oldPrice,
            image : this.state.image,
            quantity : this.state.quantity,
          }
  
        }).then(res => {
          this.componentDidMount();
          alert("Successfully");
        })
      }else{
        alert("Empty something");
      }
    }else{
      axios({
        method:'PUT',
        url :`http://localhost:3007/products/${this.state.id}`,
        data: {
          name: this.state.name,
          price: this.state.price,
          oldPrice : this.state.oldPrice,
          image : this.state.image,
          quantity : this.state.quantity,
        }

      }).then(res => {
        this.componentDidMount();
        alert("Successfully");
      })
    }
    this.setState({
      id:'',
      name:'',
      quantity:'',
      price : '',
      oldPrice : '',
      image : '',
    });
  }
 onDelete = (id) =>{
        console.log(id);
         axios({
          method: 'DELETE',
          url :`http://localhost:3007/products/${id}`,
          data : null
        }).then(res =>{
            if (res.status ===  200) {
              var index = this.getIndexProducts(id);
              if (index!==-1){
                var products = this.state.products;
                products.splice(index,1);
              }
                this.setState({
                  products :products
                });
                alert(id);
                toast.success("Xóa sản phẩm thành công", {
                })
            }
        });}
  render() {
    return (
    <div className="container">
      <div className="row">
          <div className="col-4">
          <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">Thêm sản phẩm</button>
          <form onSubmit={this.onSave}>
          <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                <div className="form-group">
              <label htmlFor="exampleInputEmail1">Name</label>
              <input
                type="text"
                name="name"
                value={this.state.name}
                onChange = {this.onChange}
                className="form-control"
                id="exampleInputEmail1"
                aria-describedby="emailHelp"
                placeholder="Enter name"
              />
            </div>
            <div className="form-group">
              <label htmlFor="exampleInputPassword1">Quantity</label>
              <input
                type="text"
                name="quantity"
                onChange = {this.onChange}
                value={this.state.quantity}
                className="form-control"
                id="exampleInputPassword1"
                placeholder="Quantity"
              />
            </div>
            <div className="form-group">
              <label htmlFor="exampleInputEmail2">Price</label>
              <input
                type="text"
                name="price"
                onChange = {this.onChange}
                value={this.state.price}
                className="form-control"
                id="exampleInputEmail2"
                aria-describedby="emailHelp"
                placeholder="Enter price"
              />
            </div>
            <div className="form-group">
              <label>Image</label>
              <input
                type="file"
                name="image"
                onChange = {this.onChangeImage}
                className="form-control"
                placeholder="image"
              />
            </div>
            <div className="form-group" id = "image-edit" style={{ display: "none" }}>
              <label>Image</label>
                <img src={"./"+this.state.image} style={{ width: "100px" }}/>
            </div>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              <button type="submit" class="btn btn-primary">Submit</button>
                </div>
              </div>
            </div>
          </div>
          </form>
          </div>
          <div className="col-8">
          <div className="row">
          { this.state.products.map((product) =>(
                  <div className="col-12 col-sm-6 col-md-4 single_gallery_item women wow fadeInUpBig" data-wow-delay="0.3s">
                  {/* Product Image */}
                   <div className="product-img">
                      <img src={product.image} alt="" />
                      <div className="product-quicview">
                        <a href="#" data-toggle="modal" data-target="#quickview"><i className="ti-plus" /></a>
                      </div>
                    </div>
                    {/* Product Description */}
                  <div className="product-description">
                      <h4 className="product-price">$  {product.price }</h4>
                      <p>{product.name}</p>
                      {/* Add to Cart */}
                     {/* <a href="#" className="add-to-cart-btn" onClick={() => successAlert(product.name)}> ADD TO CART</a> */}
                     <button className="btn btn-primary" onClick={() =>this.showEditProduct(product.id)}  data-toggle="modal" data-target="#exampleModal">Edit</button>
                     <button className="btn btn-danger" onClick={() =>this.onDelete(product.id)}>Delete</button>
                    </div>
                  </div>
            ))
          }
          </div>
        </div>
      </div>
    </div>
    );
  }
}
export default Product;


